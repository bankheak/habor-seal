# Set working directory here
setwd("C:/Users/bankh/My_Repos/habor-seal/data")
# Retrieve data
m.data<-read.csv("m.data.csv")
# Combine location avg noise and total seals within dates
new.w.data<-read.csv("new.w.data.csv")
# Fix date
new.w.data$date<-as.Date(as.character(new.w.data$date),format = "%m/%d/%Y")
m.data$date<-as.Date(as.character(m.data$date),format = "%m/%d/%Y")
new.w.data$j.date<- as.integer(new.w.data$j.date)
m.data$j.date<- as.integer(.data$j.date)
# Add sample ID
new.w.data$id<- seq_along(new.w.data[,1])
m.data$id<- seq_along(m.data[,1])
# Merge data
full.data<-merge(new.w.data,m.data,all = T)
### Check if overdispersion is detected with full model
mod<- glm.nb(seals ~ site*noise + month + tide + time, data = full.data)
require(MASS) # for glm
### Check if overdispersion is detected with full model
mod<- glm.nb(seals ~ site*noise + month + tide + time, data = full.data)
summary(mod)
check_overdispersion(mod)
### Check if overdispersion is detected with full model
mod<- glm.nb(seals ~ site*noise + month, data = full.data)
summary(mod)
View(full.data)
View(m.data)
full.data$site<- as.numeric(full.data$site=="waterfront")
### Check if overdispersion is detected with full model
mod<- glm.nb(seals ~ site*noise + month, data = full.data)
summary(mod)
## Plot lines
attach(full.data)
plot(noise[site==1],seals[site==1],type="p",pch=paste(1), col="blue", xlim=c(min(noise),max(noise)), ylim=c(min(seals),max(seals)), xlab="Noise",ylab="Seals")
plot(noise[site==1],seals[site==1],type="p",pch=paste(1), col="blue", xlim=c(min(noise),max(noise)), ylim=c(min(seals),max(seals)), xlab="Noise",ylab="Seals")
abline(lm(seals[site==1]~noise[site==1]),col="blue") # add regression line for polymer 1
points(noise[site==0],seals[site==0],type="p",pch=paste(2), col="red") # add points corresponding to polymer 2
abline(lm(seals[site==0]~noise[site==0]),col="red") # add regression line for polymer 2
plot(noise[site==1],seals[site==1],type="p",pch=paste(1), col="blue", xlim=c(min(noise),max(noise)), ylim=c(min(seals),max(seals)), xlab="Noise",ylab="Seals")
plot(noise[site==1],seals[site==1],type="p",pch=paste(1), col="blue", xlim=c(min(noise),max(noise)), ylim=c(min(seals),max(seals)), xlab="Noise",ylab="Seals")
abline(glm.nb(seals[site==1]~noise[site==1]),col="blue") # add regression line for polymer 1
points(noise[site==0],seals[site==0],type="p",pch=paste(2), col="red") # add points corresponding to polymer 2
abline(glm.nb(seals[site==0]~noise[site==0]),col="red") # add regression line for polymer 2
